# 开发日志

## 开发日志

| 项                                                           | 是否完成 | 完成日期 |
| ------------------------------------------------------------ | -------- | -------- |
| 推送完成后，直接启动 Worker                                  |          |          |
| 修改配置文件与异步部署逻辑：1、进一步降低藕合；2、降低配置文件内存负载 |          |          |
| 节点 init 时配置 datalight 用户的无秘钥访问                  | √        |          |
| 节点 init 时检查 datalight 用户的无秘钥访问                  | √        |          |
| 节点 init 时设置 datalight 用户的 JDK 设置                   | √        |          |
| 检查 datalight 用户的 JDK 设置                               | √        |          |
| 在原有的定时任务中，如果检查到有 RESTARTING 的节点，则 SSH 探测该节点，如果连通，则改为 STARTED 状态 | √        |          |
| 服务部署、服务组件启动停止等操作                             | √        |          |
| 修复 重启 和 关机造成的异常                                  | √        |          |
| 分布式日志聚合管理（不入库，Worker 扫描，实时读取）          |          |          |
| 编写各种格式配置文件的解析工具和函数，实现配置文件动态联动修改（插件的内部细节） |          |          |
| 初始化 YAML 配置格式，内容正确性检查，例如 服务名称、组件名称是否在 YAML 配置中存在重复 等 |          |          |
| 初始化 YAML 动态重加载                                       |          |          |
| 验证部署请求的合理性，在异步任务组装之前进行拦截             |          |          |
| REMOVE 组件时，要连带删除配置文件以及检查服务是否应该处于 REMOVED，最终，删除所有 REMOVED 状态的服务和组件，以及对应的配置文件（通过状态发布实） |          |          |
| 推送安装包时，检查安装包是否已存在，如果存在，提示是否覆盖   |          |          |
| 节点重启或关机时，可能会涉及到数据库所在节点，重新启动 Master 时，需要先将 节点状态 修改为正常值 | √        |          |
| 删除组件之前，判断组件是否停止，删除服务之前，判断组件是否均删除，或服务下所有组件均删除时，删除对应服务。 |          |          |
| 删除节点时，判断该节点上是否还存在非 REMOVED 的组件          |          |          |
| Master 启动 Worker 时，向 Worker 暴露自身位置到 Worker 内存缓存 | √        |          |
| Worker 定时向 Master 获取当前服务组件的部署状态，以便实现进程自动拉起 | √        |          |
| 考虑 NameNode1 或 NameNode2 节点变更的问题                   |          |          |
| 检查 ZKFC1 ZKFC2 是否分别在 NN1 NN2 上均有部署               |          |          |
| 初始化环境是否传入 clear（判断是否字啊部署时清楚已有部署的目录等信息） |          |          |
| 增加一键清除数据库中过期的配置文件的功能                     |          |          |
| 监控告警应主动变更组件的当前状态                             |          |          |
| 设置一件清除过期数据的内容                                   |          |          |
| 更改配置文件后，增加组件需要重启的提醒                       |          |          |
| 支持针对某个集群的一键关机，一键重启                         |          |          |
| 支持针对某个集群的一键启动所有服务，一键关闭所有服务，一键重启所有服务 |          |          |
| 编写查询 Job 和 NodeJob 中的 Step 和 NodeStep 日志接口       |          |          |
| 编排各个服务的监控指标，日志目录，PID 文件管理等             |          |          |
| 设置自动拉起开关                                             |          |          |
| 服务组件的自动拉起                                           |          |          |
| 配置文件内容共享，降低 MySQL 数据冗余                        | √        |          |
| 支持配置文件自动分组                                         |          |          |
| 如果 Prometheus 配置文件发生了变更，则不不应该广播给其他服务配置文件发生了变动 | √        |          |
| 配置 MySQLExporter                                           | √        |          |
| 配置 AlertManager                                            | √        |          |
| 封装 Grafana API                                             |          |          |
| 设置服务组件部署后，自动配置 Dashboard                       |          |          |
| 通过拦截器实现审计                                           |          |          |



## 服务组件支持

| 服务           | 版本     | 是否已支持 | 完成日期       |
| -------------- |--------|------------|------------|
| ZOOKEEPER      | 3.8.2  | √          | 2023-07-31 |
| HDFS           | 3.2.4  | √          | 2023-07-31 |
| YARN           | 3.2.4  | √           | 2023-08-31 |
| PROMETHEUS     | 2.46.0 | √           | 2023-08-10 |
| ALERTMANAGER   | 0.26.0 | √           | 2023-08-10 |
| GRAFANA        | 10.1.0 | √           | 2023-08-10 |
| HIVE           | 3.1.3  | √           | 2023-09-13 |
| TEZ | 0.9.2  | √ | 2023-09-13 |
| HBASE          |        | √           |            |
| SPARK          |        | √           |            |
| FLINK          |        |            |            |
| HUDI           |        |            |            |
| KUBESPHERE     | 3.3.2  | √           | 2023-09-06 |
| SEATUNNEL      |        |            |            |
| DOPHINSCHDULER |        |            |            |
| RANGER         |        |            |            |
| ATLAS          |        |            |            |
| HUE            |        |            |            |
| KAFKA          |        |            |            |
| ES             |        |            |            |
| TRINO          |        |            |            |
| KYLIN          |        |            |            |
| KUDU           |        |            |            |
| IMPALA         |        |            |            |