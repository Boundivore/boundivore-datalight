groups:
  - name: DataLight
    rules:
      - alert: NodeManagerDown
        expr: process_start_time_seconds{job="YARN-NodeManager"} == 0
        for: 10s
        labels:
          severity: warning
          hostname: |
            {{- $instance := $labels.instance }}
            {{- if matches $instance "^.*\\..*$" }}
              {{- $instance | regexReplaceAll "(.*)\\..*" "$1" }}
            {{- else }}
              {{- $instance | regexReplaceAll "(.*):.*" "$1" | reReplaceAll "^(.*)$" "$1" }}
            {{- end }}
        annotations:
          summary: "{{ $labels.job }} 进程在 {{ $labels.hostname }} 宕机"
          description: "{{ $labels.job }} 进程在 {{ $labels.hostname }} 已经宕机超过5分钟"