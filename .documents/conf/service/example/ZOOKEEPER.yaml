# 一下内容为参考说明，并不严谨的表示部署设置的正确性，严谨说明还请参考具体的服务配置问阿金
datalight:
  service:
    name: ZOOKEEPER
    tgz: zookeeper-3.5.9.tar.gz
    conf-dirs:
        # {{SERVICE-PATH}} 将在程序中替换为 DataLight 部署服务时的安装路径，也可以不使用该变量，填写对决路径
      - service-conf-dir: '{{SERVICE_DIR}}/ZOOKEEPER/bin'
        # 配置文件模板文件，与上述路径按照顺序一一对应
        templated-dir: '{{DATALIGHT_DIR}}/plugins/templated/ZOOKEEPER/bin'

      - service-conf-dir: '{{SERVICE_DIR}}/ZOOKEEPER/conf'
        templated-dir: '{{DATALIGHT_DIR}}/plugins/templated/ZOOKEEPER/conf'

      - service-conf-dir: '{{DATA_DIR}}'
        templated-dir: '{{DATALIGHT_DIR}}/plugins/templated/ZOOKEEPER/id'
    version: 3.5.9
    # 所依赖的服务发生配置变动时，触发事件处理的具体类
    config-event-handler-jar: 'plugin-zookeeper-1.0.0.jar'
    config-event-handler-clazz: 'cn.boundivore.dl.plugin.zookeeper.config.event.ConfigEventHandler'
    components:
      # 自定义组件名称必须全局唯一，建议以官方称呼为前提，也可自定义
      - name: QuarumPeermain
        priority: 1
        # 最多可以部署多少个实例，-1 为无限制
        max: -1
        # 最少部署多少个实例
        min: 3
        # 互斥的组件名，出现互斥时，不能部署于同一节点
        mutexes: [ ]
        # 对当前组件的可执行行为
        actions:
          - type: DEPLOY
            # 执行开始时，当前组件状态变更为指定值，值参考：SCSStateEnum.java
            start-state: DEPLOYING
            # 执行成功时，当前组件状态变更为指定值，，值参考：SCSStateEnum.java
            success-state: STARTED
            # 执行失败时，当前组件状态变更为指定值，值参考：SCSStateEnum.java
            fail-state: SELECTED
            steps:
              # 执行的步骤类型，参考：StepTypeEnum.java
              - type: SCRIPT
                name: "步骤名称1"
                shell: "deployQuarumPeermain1.sh"
                # 执行脚本传入的参数
                args: [ ]
                # 执行脚本传入的交互参数，使用方法参考：BashExecutor.java 中的注释
                interactions: [ ]
                # 指定当前脚本执行成功的退出码，默认为 0
                exits: '0'
                # 脚本执行的超时时间
                timeout: 60000
                # 指定当前步骤执行完毕后，是否阻塞指定的时间后执行下一步骤
                sleep: 1000

              - type: COMMAND
                name: '步骤名称2'
                shell: 'echo deployQuarumPeermain2'
                args: [ ]
                interactions: [ ]
                exits: '0'
                timeout: 60000
                sleep: 1000

              - type: JAR
                name: '步骤名称3'
                jar: 'plugin-zookeeper-1.0.0.jar'
                clazz: 'cn.boundivore.dl.plugin.zookeeper.config.ConfigZookeeper'
                args: [ ]
                interactions: [ ]
                exits: '0'
                sleep: 1000

          - type: START
            steps:
              - type: SCRIPT
                name: '步骤名称1'
                shell: 'startQuarumPeermain1.sh'
                args: [ ]
                interactions: [ ]
                exits: '0'
                timeout: 60000
                sleep: 1000

              - type: COMMAND
                name: '步骤名称2'
                shell: 'echo startQuarumPeermain2'
                args: [ ]
                interactions: [ ]
                exits: '0'
                timeout: 60000
                sleep: 1000

              - type: JAR
                name: '步骤名称3'
                jar: 'plugin-zookeeper-1.0.0.jar'
                clazz: 'cn.boundivore.dl.plugin.zookeeper.config.ConfigZookeeper'
                args: [ ]
                interactions: [ ]
                exits: '0'
                timeout: 60000
                sleep: 1000

      - name: Client
        priority: 2
        max: -1
        min: 0
        mutexes: [ ]
        actions:
          - type: DEPLOY
            steps:
              - type: SCRIPT
                name: '步骤名称1'
                shell: 'deployClient1.sh'
                args: [ ]
                interactions: [ ]
                exits: '0'
                timeout: 60000
                sleep: 1000

              - type: COMMAND
                name: '步骤名称2'
                shell: 'echo deployClient2'
                args: [ ]
                interactions: [ ]
                exits: '0'
                timeout: 60000
                sleep: 1000

              - type: JAR
                name: '步骤名称3'
                jar: 'plugin-zookeeper-1.0.0.jar'
                clazz: 'cn.boundivore.dl.plugin.zookeeper.config.ConfigZookeeper'
                args: [ ]
                interactions: [ ]
                exits: '0'
                sleep: 1000

          - type: START
            steps:
              - type: SCRIPT
                name: '步骤名称1'
                shell: 'startClient1.sh'
                args: [ 123, 456 ]
                interactions: [ QWE ]
                exits: '0'
                timeout: 60000
                sleep: 1000
